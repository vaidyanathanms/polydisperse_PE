How to use the MATLAB files:

./ refers to directory where MATLAB files are 

Copy all output from Mesabi into the sim_results directory (make if it doesn't exist). 

If copy_to_analyze.py is used before copying the files to be analyzed, only ../../sim_results and ../../monads needs to be made


***** File 1: adsfrac.m *********************************************************************
Use adsfrac.m to compute the adsorbed fraction of CHAINS. 
Inputs should be in ../../sim_results/outresults_dir_n_*
With ttestflag ON, this also writes the individual avg_f values for each case into ../../ttest_dir.
Outputs to ../../outfiles and its subdirectory

***** File 2: basic_ttest.m ******************************************************************
Use basic_ttest.m to compute the tvalue between any two ref archs at a given pdi and n_pa value.
Requires output from adsfrac.m. 
Run adsfrac.m before running this code.
USE TAB as delimiters when using text to columns in EXCEL to view the file outputs (this may not be required. depends on the editor used).

**** File 3: analyze_pdi_mw_dist.m ***********************************************************
Use this to compute the pdi and mw distribution for any given configuration.
Input requires the datafile generated by LAMMPS.
Dependencies: compute_pdi.m, compute_mwdist.m

**** File 4: out_mwdist.m *********************************************************************
Use this to compute the MW distribution of the adsorbed polymer fraction.
Input requires the chainadsval_rcut_* for all the configurations. Use FORTRAN codes (pe_analyze.f90/pe_main.f90) to analyze the trajectories generated by LAMMPS to generate chainadsval_rcut_* files. 
Dependencies: extract_adschain.m, find_distribution_of_mw.m
Output: generates the adsorbed fraction for the range of MWs. See the code for algorithm

**** File 5: avg_and_coarsen_dist.m *********************************************************************
Plots the distribution of fraction of chains adsorbed after averaging/coarsening
Run out_mwdist.m before doing this.

***** File 6: adsfrac_mons.m *********************************************************************
Use adsfrac.m to compute the adsorbed fraction of MONOMERS. 
Inputs should be in the directory ../../sim_results/outresults_dir_n__*
Outputs to ../../monads and its subdirectory

***** File 7: plot_paper.m *********************************************************************
To plot the data for the paper. See code comments for instructions

***** File 8: netcharge_brush.m *********************************************************************
Input files required are  ./../../data_all_dir/n_*/PEinitdata.txt and ./../../sim_results/outresults_dir_n_%d/%s/pdifree_%s_pdigraft_%s/Case_%d/dens_config*.lammpstrj
Output files will be in ./../../net_charge
Run plot_paper.m to obtain the plots after running this

***** File 8: compute_adsfrac_newdef.m *********************************************************************
Input files required are  ./../../monads/outresults_dir_n_%d/%s/pdifree_%s_pdigraft_%s/Case_%d/adsfrac_chmw_config*.lammpstrj
Computes the adsorbed fraction of monomers according to the definition that if a chain is adsorbed, the number of monomers adsorbed is equal to the MW of the chain.
Output files will be in ./../../monads/overall/
Run plot_paper.m to obtain the plots after running this

***** File 9: generate_numavgMW.m *********************************************************************
Input files required are  ./../../numavg_mw/outresults_dir_n_%d/%s/pdifree_%s_pdigraft_%s/Case_%d/adsfrac_chain_config*.lammpstrj AND ./../../numavg_mw/outresults_dir_n_%d/%s/pdifree_%s_pdigraft_%s/Case_%d/adsfrac_chmw_config*.lammpstrj
NOTE: Make sure that the files have the same timestep prefixed to *.lammpstrj.
Generates the time data for the number averaged MW.
Output files will be in the same directory where input files are found with adsfrac_numavg_config*.lammpstrj.
Run compute_numavgMW.m after this.

***** File 10: compute_numavgMW.m *********************************************************************
Input files required are  ./../../numavgMW/outresults_dir_n_%d/%s/pdifree_%s_pdigraft_%s/Case_%d/adsfrac_numavg_rcut_*_config*.lammpstrj
Output files will be in ./../../outfiles/overall/
Computes number averaged MW
Run plot_paper.m to obtain the plots after running this

***** File 11: fit_to_theory_v2.m *********************************************************************
Input files required are  ./../../Figs_Paper/fig7_*_distribution.fig (* corresponds to 'blbl' or 'alal'
The code reads the distribution figure and analyzes
Computes regression to the model presented in the paper and the output regression values
Output files: '../../Figs_Paper/alal_panel*.eps' or '../../Figs_Paper/blb_panel*.eps' and all linear fit data.
Regressed coefficients are found in '../../outfiles/overall/*_regression.dat' where * corresponds to blbl or alal.

***** File 12: *_seq.m *********************************************************************
Input files required are in ./../../seq_analysis
The code does the corresponding postprocessing as for Files 1,3,4,7-10 except for different sequence at fixed npa
Output files are in ./../../seq_analysis